(self.webpackChunkgames_ui=self.webpackChunkgames_ui||[]).push([[443],{3443:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(5671),n=a(3144),o=a(7326),s=a(136),i=a(6215),c=a(1120),l=a(7294),u=a(1977),d=a(818),m=a(3352),p=a(6431),f=function(){function e(){(0,r.Z)(this,e)}return(0,n.Z)(e,null,[{key:"submitChosenCard",value:function(e,t){return new Promise((function(a,r){p.Z.post("ass/".concat(e,"/submit"),t).then((function(e){return a(e)})).catch((function(e){return r(e)}))}))}}]),e}(),h=a(7674),y=a(6486),g=a(9755);const v=function(e){(0,s.Z)(v,e);var t,a,p=(t=v,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(a){var n=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function v(){var e;return(0,r.Z)(this,v),(e=p.call(this)).state=y.assign({myIndexInPlayersInGame:-1,amIPresentInPlayersInGame:!1},e.getInitialValues()),e.animationTime=1e3,e.updateGameInfo=e.updateGameInfo.bind((0,o.Z)(e)),e.updateReceived=e.updateReceived.bind((0,o.Z)(e)),e.setChosenCard=e.setChosenCard.bind((0,o.Z)(e)),e.submitChosenCard=e.submitChosenCard.bind((0,o.Z)(e)),e.restartGame=e.restartGame.bind((0,o.Z)(e)),e.handleError=m.Z.handleError.bind((0,o.Z)(e)),e}return(0,n.Z)(v,[{key:"getInitialValues",value:function(){return{submitFlag:!1,chosenCard:null}}},{key:"startAnimi",value:function(e){var t=this;return new Promise((function(a){setTimeout((function(){g(".game-player-selected-card").removeClass("game-player-selected-card-force"),g(".game-player-selected-card").animate(e,t.animationTime),setTimeout((function(){g(".game-player-selected-card").addClass("game-player-selected-card-force"),a()}),t.animationTime+100)}),500)}))}},{key:"setCardsPosition",value:function(){document.querySelectorAll(".game-player-selected-card").forEach((function(e){var t=g(e).offset();g(e).css({position:"fixed",top:t.top,left:t.left})}))}},{key:"checkAnime",value:function(e){var t=this;return new Promise((function(a){if(y.isEmpty(e.currentRoundPlayerCards)&&e.lastRound)switch(e.lastRound.type){case"ALL_SUBMITTED":t.props.updateGameInfo({currentRoundPlayerCards:e.lastRound.playersCards}).then((function(){t.setCardsPosition(),t.startAnimi({left:"-100px"}).then(a)}));break;case"HIT":t.props.game.currentRoundPlayerCards[e.lastRound.hitBy._id]=e.lastRound.hitBy._id==t.props.me._id?t.state.chosenCard:{},t.props.updateGameInfo({currentRoundPlayerCards:t.props.game.currentRoundPlayerCards}).then((function(){t.setCardsPosition();var r=g("[data-player-id='".concat(e.lastRound.playerGotHit._id,"'] .game-player-selected-card")).offset();t.startAnimi({top:r.top,left:r.left}).then(a)}))}else a()}))}},{key:"updateGameInfo",value:function(e){var t=this;this.setState(this.getInitialValues(),(function(){return t.props.updateGameInfo(e)}))}},{key:"beforeUpdateInfo",value:function(e){var t=this;this.checkAnime(e).then((function(){return t.updateGameInfo(e)}))}},{key:"isPlayerWon",value:function(e){return"STARTED"==this.props.game.status&&y.find(this.props.game.players,{_id:e._id})&&!y.find(this.props.game.playersInGame,{_id:e._id})}},{key:"listPlayers",value:function(){var e=this,t=this.props.game,a=t.players,r=t.currentRoundPlayerCards;return l.createElement("div",{className:"d-flex flex-wrap px-1 mt-2"},a.map((function(t,a){return l.createElement(u.Z,{key:a,gameId:e.props.game._id,gameName:"ass",player:t,isMe:t._id==e.props.me._id,currentPlayer:e.props.game.currentPlayer,amIAdmin:e.props.state.amIAdmin,isPlayerWon:e.isPlayerWon(t),CardComponent:h.Z,playerChosenCard:r[t._id]})})))}},{key:"submitChosenCard",value:function(){var e=this,t=this.state.chosenCard;this.setState({submitFlag:!0},(function(){f.submitChosenCard(e.props.game._id,{chosenCard:t}).then((function(t){e.props.updateGameInfo({myCards:t.myCards}).then((function(){return e.beforeUpdateInfo(t)}))})).catch(e.handleError)}))}},{key:"getSubmitButton",value:function(){var e=this.state,t=e.chosenCard,a=e.submitFlag;return l.createElement("div",{className:"d-flex my-2"},l.createElement("button",{className:"btn btn-primary m-auto btn-shadow",onClick:this.submitChosenCard,disabled:null==t||a},"Submit"))}},{key:"setChosenCard",value:function(e){this.setState({chosenCard:this.isChosenCard(e)?null:e})}},{key:"sortMyCards",value:function(e){return y.reverse(y.sortBy(e,["type","point"]))}},{key:"isChosenCard",value:function(e){var t=this.state.chosenCard;return t&&t.number==e.number&&t.type==e.type}},{key:"showMyCards",value:function(){var e=this,t=this.props.game.myCards,a=!this.props.state.isMyMove;return l.createElement("div",{className:"my-cards"},this.sortMyCards(t).map((function(t,r){return l.createElement(h.Z,{onClick:e.setChosenCard,isChosenCard:e.isChosenCard(t),card:t,key:r,disabled:a})})))}},{key:"getPlayerTurnAlert",value:function(){return l.createElement("div",{className:"d-flex py-2"},l.createElement("span",{className:"m-auto sg-btn-".concat(this.props.state.isMyMove?"danger":"trans"," ")},this.props.state.isMyMove?l.createElement("b",null,"Your turn"):l.createElement("span",null,l.createElement("b",null,this.props.game.currentPlayer.name)," turn")))}},{key:"amISpectating",value:function(){return!this.props.state.amIPresentInPlayers&&l.createElement("div",{className:"alert alert-warning text-center"},l.createElement("b",null,"You are spectaing the Game"))}},{key:"renderGame",value:function(){return l.createElement("div",{className:"d-flex flex-column"},this.getPlayerTurnAlert(),this.listPlayers(),this.getSubmitButton(),this.showMyCards(),this.amISpectating())}},{key:"restartGame",value:function(){d.Z.restartGame("ass",this.props.game._id).then(this.props.updateGameInfo).catch(this.handleError)}},{key:"renderGameResults",value:function(){var e=this,t=this.props.game,a=t.playersInGame,r=t.players;return l.createElement("div",{className:"game-result text-center"},l.createElement("div",{className:"alert alert-success text-center m-0 rounded-top rounded-bottom-0",style:{boxShadow:"0 0 5px white"}},l.createElement("b",null,"Game Results")),l.createElement("div",{className:"game-result-table"},l.createElement("table",{className:"table table-hover table-light table-striped rounded-bottom",style:{boxShadow:"0 0 5px white"}},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{scope:"col"},"Name"),l.createElement("th",{scope:"col"},"Status"),l.createElement("th",{scope:"col"},"Bal Cards"))),l.createElement("tbody",null,r.filter((function(e){return-1==y.findIndex(a,{_id:e._id})})).map((function(t,a){return l.createElement("tr",{key:a},l.createElement("td",null,t._id==e.props.me._id?"You":t.name),l.createElement("td",null,"Won"),l.createElement("td",null,"-"))})),a.map((function(t,a){return l.createElement("tr",{key:a},l.createElement("td",null,t._id==e.props.me._id?"You":t.name),l.createElement("td",null,"Lost"),l.createElement("td",null,y.find(r,{_id:t._id}).cardsCount))}))))),this.amISpectating(),this.props.state.amIAdmin&&l.createElement("div",{className:"d-flex"},l.createElement("button",{className:"btn btn-primary m-auto btn-shadow",onClick:this.restartGame},"Restart")))}},{key:"prepareFields",value:function(e){var t=y.findIndex(e.game.playersInGame,{_id:e.me._id});this.setState({myIndexInPlayersInGame:t,amIPresentInPlayersInGame:-1!=t})}},{key:"render",value:function(){switch(this.props.game.status){case"STARTED":return this.renderGame();case"ENDED":return this.renderGameResults()}}},{key:"componentDidMount",value:function(){this.prepareFields(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.prepareFields(e)}},{key:"updateReceived",value:function(e){var t=this;"PLAYER_SUBMITTED_CARD"===e.event&&this.checkAnime(e.gameData).then((function(){var a=e.gameData.lastRound;if(a&&a.playerGotHit&&a.playerGotHit._id==t.props.me._id)return t.props.getGameInfo();t.updateGameInfo(e.gameData)}))}}]),v}(l.Component)},7674:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var r=a(5671),n=a(3144),o=a(136),s=a(6215),i=a(1120),c=a(7294),l=(a(5111),a(6486));var u=function(e){(0,o.Z)(d,e);var t,a,u=(t=d,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,i.Z)(t);if(a){var n=(0,i.Z)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return(0,s.Z)(this,e)});function d(){return(0,r.Z)(this,d),u.call(this)}return(0,n.Z)(d,[{key:"getOnClick",value:function(){var e=this.props,t=e.card,a=e.onClick;return 1!=e.disabled&&"function"==typeof a?function(){return a(t)}:function(){}}},{key:"getTextColorClass",value:function(){switch(this.props.card.type){case"SPADE":case"CLUB":return"text-dark";default:return"text-danger"}}},{key:"getCardClass",value:function(){var e=this.props,t=e.isChosenCard,a=e.className;return["game-card",t?"game-chosen-card":"",this.getTextColorClass(),a].join(" ")}},{key:"getJokerCard",value:function(){var e=l.toArray("JOKER").map((function(e,t){return c.createElement("div",{key:t},e)}));return c.createElement("div",{className:"d-flex joker-card text-danger"},c.createElement("div",{className:"left"},e),c.createElement("div",{className:"center"},c.createElement("img",{src:"/assets/images/joker.png"})),c.createElement("div",{className:"right"},e))}},{key:"getLayer",value:function(e,t,a){return c.createElement("div",{className:"d-flex flex-column ".concat(a)},e,t)}},{key:"getNumberCard",value:function(e){var t=c.createElement("div",{className:"game-card-corner-text"},e.number);return c.createElement("div",{className:"position-relative h-100 w-100 d-flex flex-column game-card-body"},this.getLayer(t,c.createElement("div",{className:"".concat(e.type,"-icon game-card-corner-icon")}),"mbr-auto"),this.getLayer("",c.createElement("div",{className:"".concat(e.type,"-icon game-card-center-icon")}),""),this.getLayer(c.createElement("div",{className:"".concat(e.type,"-icon game-card-corner-icon")}),t,"mlt-auto"))}},{key:"getGameCardBody",value:function(){var e=this.props.card;return"JOKER"===e.type?this.getJokerCard():this.getNumberCard(e)}},{key:"render",value:function(){return c.createElement("div",{onClick:this.getOnClick(),className:this.getCardClass()},this.getGameCardBody())}}]),d}(c.Component)},1977:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var r=a(5671),n=a(3144),o=a(7326),s=a(136),i=a(6215),c=a(1120),l=a(4942),u=a(7294),d=a(7814),m=a(818),p=a(3352);a(8803);var f=function(e){(0,s.Z)(h,e);var t,a,f=(t=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(a){var n=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function h(){var e;return(0,r.Z)(this,h),e=f.call(this),(0,l.Z)((0,o.Z)(e),"nudgePlayer",(function(){var t=e.props,a=t.isMe,r=t.amIAdmin;if(!a&&r){var n=e.props,o=n.gameName,s=n.gameId,i=n.player;m.Z.nudgePlayer(o,s,i._id).catch(e.handleError)}})),e.handleError=p.Z.handleError.bind((0,o.Z)(e)),e}return(0,n.Z)(h,[{key:"getPlayerBorderColor",value:function(){return"sg-border-".concat(this.props.isMe?"warning":"primary")}},{key:"isPlayerCurrentPlayer",value:function(){var e=this.props,t=e.currentPlayer,a=e.player;return t&&t._id==a._id}},{key:"getPlayerBtn",value:function(){return"sg-btn".concat(this.isPlayerCurrentPlayer()?"-light":"")}},{key:"getPlayerBtnClassName",value:function(){return["player-card",this.getPlayerBtn(),this.getPlayerBorderColor()].join(" ")}},{key:"render",value:function(){var e=this.props,t=e.player,a=e.isMe,r=e.playerChosenCard,n=e.CardComponent,o=e.hideInfo,s=e.isPlayerWon,i=e.additionalInfo;return u.createElement("div",{className:"player-card-outer","data-player-id":t._id},u.createElement("button",{className:this.getPlayerBtnClassName(),onClick:this.nudgePlayer,title:t.name},u.createElement("div",{className:"flex-column"},u.createElement(d.G,{icon:"user",className:"player-icon"}),u.createElement("div",{className:"player-name"},t.name,a&&" (You)"),i&&i(),1!=o&&(s?u.createElement("span",{className:"px-2 m-auto bg-success rounded text-white"},"Won"):u.createElement("div",null,u.createElement("div",{className:"text-center",style:{fontSize:"10px"}},u.createElement("b",null,"(",t.cardsCount,")")),n&&u.createElement("div",{className:"game-player-selected-card-back"},r&&u.createElement(n,{card:r,className:"game-player-selected-card game-player-selected-card-force"})))))))}}]),h}(u.Component)},818:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var r=a(5671),n=a(3144),o=a(6431),s=function(){function e(){(0,r.Z)(this,e)}return(0,n.Z)(e,null,[{key:"getGameInfo",value:function(e,t){return new Promise((function(a,r){o.Z.get("game/".concat(t,"/info"),{gameName:e}).then((function(e){return a(e)})).catch((function(e){return r(e)}))}))}},{key:"startGame",value:function(e,t){return new Promise((function(a,r){o.Z.post("".concat(e,"/").concat(t,"/start")).then((function(e){return a(e)})).catch((function(e){return r(e)}))}))}},{key:"restartGame",value:function(e,t){return new Promise((function(a,r){o.Z.post("game/".concat(t,"/restart"),{gameName:e}).then((function(e){return a(e)})).catch((function(e){return r(e)}))}))}},{key:"leaveGame",value:function(e,t){return new Promise((function(a,r){o.Z.post("".concat(e,"/").concat(t,"/leave")).then((function(e){return a(e)})).catch((function(e){return r(e)}))}))}},{key:"sendMessage",value:function(e,t,a){return new Promise((function(r,n){o.Z.post("game/".concat(t,"/message"),{gameName:e,text:a}).then((function(e){return r(e)})).catch((function(e){return n(e)}))}))}},{key:"nudgePlayer",value:function(e,t,a){return new Promise((function(r,n){o.Z.post("game/".concat(t,"/nudge"),{gameName:e,playerId:a}).then((function(e){return r(e)})).catch((function(e){return n(e)}))}))}}]),e}()},3352:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(8077),n=a(9755);function o(e){n("#".concat(e)).trigger("play")}function s(){o("error-notify")}const i={audios:["new-notify","error-notify","light-notify","buzz-notify"],playNewNotify:function(){o("new-notify")},playErrorNotify:s,playLightNotify:function(){o("light-notify")},playBuzzNotify:function(){o("buzz-notify")},vibrate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;window.navigator.vibrate(e)},resetStateGetGameInfo:function(){this.setState(this.getInitialValues(),this.props.getGameInfo())},resetStateUpdateGameInfo:function(e){var t=this;this.setState(this.getInitialValues(),(function(){return t.props.updateGameInfo(e)}))},handleError:function(e){s();var t=e.message||"Error Occurred";r.Am.error(t,{toastId:t}),this.setState(this.getInitialValues())}}},3882:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,".player-card-outer{margin:10px auto}.player-card-outer .player-card{width:70px;margin:auto 5px;border-radius:5px !important}.player-card-outer .player-name,.player-card-outer .player-additonal-info{font-weight:bold;font-size:12px;overflow:hidden;text-overflow:ellipsis}.player-card-outer .player-icon{margin:5px auto;font-size:15px}",""]),e.exports=t},8653:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,'.game-card,.game-player-selected-card-back{background:#fff;border-radius:3px;height:70px;width:45px;padding:3px;cursor:pointer;box-shadow:-5px 5px 10px #000;margin-bottom:5px;z-index:0}.game-chosen-card{transform:scale(1.1);transition:transform .2s}.game-player-selected-card-back{position:relative;margin:auto}.game-player-selected-card,.game-player-selected-card-back{height:40px;width:30px}.game-player-selected-card-force{position:absolute !important;top:0 !important;left:0 !important}.game-player-selected-card{box-shadow:none;margin:0 !important}.game-player-selected-card .game-card-body .game-card-corner-text{font-size:6px}.game-player-selected-card .game-card-body .game-card-corner-icon{margin:.5px auto;height:4px;width:4px}.game-player-selected-card .game-card-body .game-card-center-icon{height:6px;width:6px}.game-card-corner-text{text-align:center;font-size:8px;font-weight:bold}.SPADE-icon{background-image:url("/assets/images/SPADE.png");background-size:100% 100%;background-repeat:no-repeat}.CLUB-icon{background-image:url("/assets/images/CLUB.png");background-size:100% 100%;background-repeat:no-repeat}.DIAMOND-icon{background-image:url("/assets/images/DIAMOND.png");background-size:100% 100%;background-repeat:no-repeat}.HEART-icon{background-image:url("/assets/images/HEART.png");background-size:100% 100%;background-repeat:no-repeat}.game-card-corner-icon{margin:1px auto;height:6px;width:6px}.game-card-center-icon{height:15px;width:15px;margin:auto}.joker-card{width:100%;height:100%;font-size:6px;line-height:6px;font-weight:bold}.joker-card .left,.joker-card .right{display:flex}.joker-card .left{flex-direction:column}.joker-card .center{display:flex;width:100%}.joker-card .center img{margin:auto;height:30px;width:25px}.joker-card .right{margin-left:auto;margin-top:auto;flex-direction:column-reverse}',""]),e.exports=t},8803:(e,t,a)=>{var r=a(3379),n=a(3882);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},5111:(e,t,a)=>{var r=a(3379),n=a(8653);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);r(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}}}]);